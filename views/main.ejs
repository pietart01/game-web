<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin="" />
    <link
            rel="stylesheet"
            as="style"
            onload="this.rel='stylesheet'"
            href="https://fonts.googleapis.com/css2?display=swap&amp;family=Noto+Sans%3Awght%40400%3B500%3B700%3B900&amp;family=Plus+Jakarta+Sans%3Awght%40400%3B500%3B700%3B800"
    />
    <title> GAME</title>
    <link rel="icon" type="image/x-icon" href="data:image/x-icon;base64," />
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
        @media (max-width: 768px) {
            .banner-content {
                flex-direction: column;
            }
            .login-form-container {
                width: 100%;
                padding: 1rem;
            }
        }
    </style>
</head>
<body>
<div class="relative flex size-full min-h-screen flex-col bg-[#FFFFFF] group/design-root overflow-x-hidden" style='font-family: "Plus Jakarta Sans", "Noto Sans", sans-serif;'>
    <div class="layout-container flex h-full grow flex-col">
        <header class="flex items-center justify-between whitespace-nowrap border-b border-solid border-b-[#F4EFE6] px-4 sm:px-10 py-3">
            <div class="flex items-center gap-4 text-[#1C160C]">
                <div class="size-4">
                    <svg viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path
                                d="M4 42.4379C4 42.4379 14.0962 36.0744 24 41.1692C35.0664 46.8624 44 42.2078 44 42.2078L44 7.01134C44 7.01134 35.068 11.6577 24.0031 5.96913C14.0971 0.876274 4 7.27094 4 7.27094L4 42.4379Z"
                                fill="currentColor"
                        ></path>
                    </svg>
                </div>
                <h2 class="text-[#1C160C] text-lg font-bold leading-tight tracking-[-0.015em]">BEST GAME</h2>
            </div>
            <nav class="hidden sm:flex flex-1 justify-end gap-8">
                <ul class="flex items-center gap-9">
                    <% ['홈'].forEach(item => { %>
                        <li><a class="text-[#1C160C] text-sm font-medium leading-normal" href="#<%= item %>"><%= item %></a></li>
                    <% }); %>
                </ul>
            </nav>
            <button class="sm:hidden text-[#1C160C]">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-6 h-6">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path>
                </svg>
            </button>
        </header>

        <div class="w-full">
            <div class="relative w-full bg-center bg-no-repeat bg-cover flex flex-col justify-end overflow-hidden bg-[#FFFFFF] min-h-[400px]"
                 style='background-image: url("https://cdn.usegalileo.ai/sdxl10/c13c5aae-a5ad-45cc-a44b-2a965de4047d.png");'>
                <div class="banner-content absolute inset-0 flex items-center justify-end p-6 bg-black bg-opacity-50">
                    <% if (isLoggedIn) { %>
                        <%- include('user-profile', {
                        username,
                        cash,
                        gold,
                        silver,
                        avatar_url
                        }) %>
                    <% } else { %>
                        <%- include('login-form') %>
                    <% } %>
                </div>
            </div>
        </div>


        <div class="layout-content-container flex flex-col w-full px-4 sm:px-6 py-6">
            <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-3">
                <% games.forEach(game => { %>
                    <div class="flex flex-col gap-3 pb-3" onclick="gamestart('<%= game.code %>')">
                        <div
                                class="w-full bg-center bg-no-repeat aspect-square bg-cover rounded-xl"
                                style='background-image: url("<%= game.image %>");'
                        ></div>
                        <div>
                            <p class="text-[#1C160C] text-base font-medium leading-normal"><%= game.name %></p>
                            <p class="text-[#A18249] text-sm font-normal leading-normal"><%= game.description %></p>
                        </div>
                    </div>
                <% }); %>
            </div>
        </div>
    </div>
</div>
<script>
    document.addEventListener('DOMContentLoaded', function() {
/*        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const formData = new FormData(this);
            fetch('/login', {
                method: 'POST',
                body: formData
            })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        window.location.href = '/dashboard';
                    } else {
                        alert('Login failed. Please check your credentials.');
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                });
        });*/
    });

    function gamestart(gamecode){
        $.ajax({
            type: "GET",
            url: "/game/start",
            dataType: "json",
            data: {
                _method: 'get',
                game: 'slot',
                gamecode: gamecode
            },
            success: function(data){
                if(data.result == true) {
                    // Open the game in a new window
                    var newWindow = window.open(data.url, 'SlotGame', "width=1400, height=930, left=100, right=100, toolbar=no, location=no, directories=no, status=no, menubar=no, resizable=no, scrollbars=no, copyhistory=no");
                    if (!newWindow) {
                        window.location.href = data.url;
                        // alert("Popup blocked! Please allow popups for this site.");
                    }
                } else {
                    alert(data.msg);
                }
            },
            error: function(){
                alert("실패했습니다.");
            }
        });
    }

</script>
</body>
</html>

